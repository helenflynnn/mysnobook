[["index.html", "A Spatiotemporal Analysis on the Correlation between Baseflow and Peak Snow Water Equivalent in Colorado Chapter 1 Overview", " A Spatiotemporal Analysis on the Correlation between Baseflow and Peak Snow Water Equivalent in Colorado Helen Flynn 2023-05-02 Chapter 1 Overview This is a summary of my senior capstone project and independent research. Some of the skills employed for this research were streamflow and snow data analysis, R coding, mapping, generating useful figures and scientific writing. "],["abstract.html", "Chapter 2 Abstract", " Chapter 2 Abstract Baseflow is the primary source of water in snow-dominated watersheds for most of the year after the high-volume melt period has passed. The Colorado Front Range relies on low flows that result from late spring and early summer snowmelt for municipal, agricultural, and recreational purposes. Changes in the timing and amount of snowmelt due to climate change will impact water availability for millions of people on the Front Range. This study seeks to find the correlation between winter snow water equivalent (SWE) values and subsequent baseflow characteristics, including any yearly lag between the two variables. Streamflow data from US Geological Survey stations and SWE data from Natural Resource Conservation Service SNOTEL stations were examined for drainage basins of varying latitude, elevation, and area across Colorado. In snow-dominated ecosystems, the hydrograph shows a well-defined peak when snowmelt occurs in the spring that is followed by low flows in the fall and winter months. The traditional water year (WY, in the US October 1 through September 30) separates peak melt and baseflow into two different WYs. To reflect the hydrologic processes that are occurring in snow-dominated watersheds, we propose using a melt year (MY) beginning with the onset of snowmelt (the first deviation from baseflow) and ending with the onset of the following year’s snowmelt. We identified the beginning of a MY and extracted the subsequent baseflow values using flow duration curves (FDC). This is a dynamic approach to analyzing the correlation between peak SWE and baseflow. "],["intro.html", "Chapter 3 Intro 3.1 Objectives", " Chapter 3 Intro In snow-dominated watersheds, snowmelt contributions to streamflow cause a peak in the hydrograph in spring with low flows returning in the fall. This paper defines baseflow as daily streamflow with between 50 and 90 percent probability of exceedance (Smakhtin, 2001), and this also referred to as low flow. Baseflow originating as snowmelt sustains communities on Colorado’s Front Range during the winter months while water accumulates in the high elevation snowpack. In the spring, snowmelt adds significant quantities of water and increasessing flows in these streams and rivers, However, the influence of snowpack on baseflow in the fall and winter is less understood (Hammond &amp; Kampf, 2020). The traditional U.S. water year (WY, October 1st to September 30th) begins with low flows from a previous year’s snowpack (Figure 1). As the WY progresses, snow accumulates in the mountains and then begins to melt in the spring, generating a peak in the hydrograph. After peak melt, streamflow returns to low flows in the late summer and early fall. Thus, the WY contains two periods of baseflow that have influenced by snowpack from two different years (Figure 2). There are several different methods that have been used to determine baseflow including baseflow separation, frequency analysis, and flow duration curves (FDC) (Smakhtin, 2001). Additionally, tracing the movement of stable isotopes is another way to measure baseflow. Researchers have used 15-day running minimum as a proxy for baseflow as well (Cooper et al., 2018; Godsey et al., 2013). In Miller et al. 2014, they found that “baseflow ranged from as low as 40%, but up to 86%, of streamflow during low flow conditions.” They did this using isotope tracers in large basins in the Upper Colorado River Basin. For the purposes of this study, we assumed that 100% of low flow was baseflow due to the smaller size and snow-dominated nature of the basins. Similar research has been conducted in the Sierra Nevada Mountains of California using modeling to predict how summer low flows will be impacted by changes in peak SWE under a warming climate (Godsey et al., 2013). This research also suggests that there is a lag time or “memory” between when snow years deviating from average resulting in deviating baseflow. 3.1 Objectives To understand more about how water moves through these snow-dominated systems watersheds, our goals were: Compute baseflow that occurs after snowmelt and correlate peak SWE and baseflow Implement a melt year (MY) approach that identifies baseflow using that seasons’ snowmelt Correlate baseflow and peak SWE using a yearly lag from 0 to 5 years Contrast low-snow and high-snow years to correlate peak SWE and baseflow over subsequent years Appraise the peak SWE versus baseflow correlation as a function of basin characteristics such as drainage area, elevation, and latitude Figure 1: the above hydrograph shows the traditional water year (WY) denoted by the grayed boxes and the melt year (MY) in light blue. "],["data-and-methodology.html", "Chapter 4 Data and Methodology 4.1 Data 4.2 Methods", " Chapter 4 Data and Methodology Load packages library(tidyverse) library(tidyr) library(httr) library(jsonlite) library(plotly) library(lubridate) library(dataRetrieval) library(sf) library(mapview) library(readr) library(dplyr) library(purrr) library(fuzzyjoin) library(furrr) library(&quot;snotelr&quot;) library(readxl) library(stats) library(tmap) library(tigris) library(elevatr) library(raster) 4.1 Data To analyze the correlation between peak SWE and baseflow, discharge data from 13 USGS gauges in the Southern Rockies of Colorado were examined from October 1st, 1979, to September 30th, 2022. Stations with greater than ten percent missing data during the time period were excluded. The drainage basins that contain each stream gauge vary in latitude, elevation and area (Table 1). Each stream gauge was paired with an NRCS SNOTEL station within or just outside the drainage basin (Table 1). When the nearest SNOTEL station was lacking data, another nearby station was selected based on the clusters defined by Fassnacht and Derry (2010). Peak SWE data from the SNOTEL stations were used. Table 1: the USGS and SNOTEL station pairs in order of northern-most latitude to southern-most. #download the streamflow data streamstations &lt;- c(&quot;06614800&quot;, &quot;09032100&quot;, &quot;09034900&quot;, &quot;09165000&quot;, &quot;09238900&quot;, &quot;09112200&quot;, &quot;09107000&quot;, &quot;09081600&quot;, &quot;09066300&quot;, &quot;08246500&quot;, &quot;09073300&quot;, &quot;07083000&quot;) sitedata &lt;- readNWISdv(siteNumber = streamstations, parameterCd = &quot;00060&quot;, &quot;1979-10-01&quot;, &quot;2022-09-30&quot;) #create index column and remove cd column sitedata &lt;- sitedata %&gt;% mutate(., index = 1:nrow(sitedata)) %&gt;% dplyr::select(c(agency_cd, site_no, Date, X_00060_00003, index)) %&gt;% addWaterYear() #convert to mm/d and clean up columns station_met &lt;- readNWISsite(streamstations) station_met_clean &lt;- station_met %&gt;% dplyr::select(&#39;agency_cd&#39;,&#39;site_no&#39;, &#39;drain_area_va&#39;) sitedata_join &lt;- sitedata %&gt;% left_join(.,station_met_clean, by = &quot;site_no&quot;) sitedata_join &lt;- sitedata_join %&gt;% dplyr::select(c(index, agency = agency_cd.x, site_no, Date, q_cfs = X_00060_00003, drain_area_va, WY = waterYear)) %&gt;% mutate(., da_km = drain_area_va * 2.58999, q_mmd = (q_cfs * 0.0283168 * 86.4)/da_km) sitedata_clean &lt;- sitedata_join %&gt;% dplyr::select(c(index, agency, site_no, Date, WY, q_mmd)) sitedata_clean &lt;- read_csv(file = &#39;data/sitedata_clean.csv&#39;, col_names = TRUE) Below is a map of the station pair locations in the state of Colorado. #USGS guage map readyforsf &lt;- read_xlsx(&quot;~/WR440/WR440/data/stationmetadata.xlsx&quot;) %&gt;% filter(stationtype == &quot;USGS&quot;) %&gt;% rename(., Longitude = dec_long_va, Latitude = dec_lat_va, Site = stationcode) %&gt;% dplyr::select(., c(&quot;Latitude&quot;,&quot;Longitude&quot;,&quot;pairname&quot;)) usgs_sf &lt;- st_as_sf(readyforsf, coords = c(&quot;Longitude&quot;,&quot;Latitude&quot;), crs = 4326) co &lt;- tigris::states(&quot;CO&quot;, year = &quot;2000&quot;, cb = TRUE, resolution = &quot;500k&quot;, progress_bar = F) %&gt;% filter(NAME == &quot;Colorado&quot;) elev &lt;- get_elev_raster(co, z = 6) %&gt;% crop(co) qtm(co) + tm_shape(elev) + tm_raster(style = &#39;cont&#39;, palette = &#39;-YlGnBu&#39;, n = 5, legend.show = F) + tm_shape(usgs_sf) + tm_bubbles(col = &quot;gray20&quot;, size = 0.5)+ tm_shape(usgs_sf)+ tm_text(&quot;pairname&quot;, just = 0.5, size = 1, xmod = 0.75, ymod = 0.75) 4.2 Methods In snow dominated watersheds, the hydrograph demonstrates a large peak occurring at the onset of melt that eventually levels off at lower values for most of the rest of the year. The traditional water year (WY, in the US October 1 through September 30) separates peak melt and baseflow into two different WYs. To reflect the hydrologic processes that are occurring in snow-dominated watersheds, we propose using a melt year (MY) beginning with the onset of snowmelt (the first deviation from baseflow) and ending with the onset of the following year’s snowmelt (Figure 2). The beginning of the MY was defined as the day at which the rate of increase in discharge changes. avg_val &lt;- read_csv(file = &#39;data/avg_val.csv&#39;, col_names = TRUE) #find the standard deviation of average baseflow values at each station stdev &lt;- avg_val %&gt;% pivot_wider(names_from = &#39;site_no&#39;, values_from = &#39;avg_qbase&#39;) %&gt;% sapply(sd, na.rm = TRUE) stdev &lt;- stdev %&gt;% as.data.frame() %&gt;% rename(bf_sd = 1) %&gt;% rownames_to_column(&#39;site_no&#39;) %&gt;% filter(site_no != &#39;my&#39;) readyforcorrel &lt;- read_csv(&quot;data/readyforcorrel.csv&quot;) stdevsno &lt;- readyforcorrel %&gt;% pivot_wider(names_from = &#39;site_no&#39;, values_from = &#39;max_swe&#39;) %&gt;% sapply(sd, na.rm = TRUE) stdevsno &lt;- stdevsno %&gt;% as.data.frame() %&gt;% rename(swe_sd = 1) %&gt;% rownames_to_column(&#39;site_no&#39;) %&gt;% filter(site_no != c(&#39;my&#39;,&#39;q_mmd&#39;,&#39;pairname&#39;,&#39;paircode&#39;,&#39;site_id&#39;)) sd_join &lt;- stdev %&gt;% inner_join(stdevsno, by = &quot;site_no&quot;) save(sd_join, file = &#39;data/sd_join.RData&#39;) load(&#39;data/sd_join.RData&#39;) means &lt;- readyforcorrel %&gt;% dplyr::select(q_mmd,site_no,max_swe) %&gt;% group_by(site_no) %&gt;% summarise_all(funs(mean(., na.rm = TRUE))) sd_join &lt;- sd_join %&gt;% mutate(bf_cov = sd_join$bf_sd / means$q_mmd, swe_cov = sd_join$swe_sd / means$max_swe) snobox &lt;- readyforcorrel %&gt;% dplyr::select(q_mmd, pairname, max_swe, my) snobox &lt;- snobox %&gt;% pivot_longer(cols = c(&#39;max_swe&#39;,&#39;q_mmd&#39;), names_to = &#39;id&#39;, values_to = &#39;value&#39;) snobox2 &lt;- snobox %&gt;% mutate(changed = case_when(id == &#39;max_swe&#39; ~ value / 1333, id == &#39;q_mmd&#39; ~ value)) ggplot(snobox2, aes(x=pairname)) + geom_boxplot( aes(y=changed,color = id)) + scale_y_continuous( name = &quot;Average Baseflow (mm/d)&quot;, sec.axis = sec_axis(~.*1333, name=&quot;Peak SWE (mm)&quot; ))+ labs(x = &quot;Pairname&quot;)+ theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1), panel.background = element_rect(fill = &quot;white&quot;,colour = &quot;black&quot;), panel.grid.minor.x = element_line(colour = &quot;black&quot;), legend.key = element_rect(fill = &quot;white&quot;), legend.justification = c(&quot;right&quot;, &quot;top&quot;), legend.position = c(.98, .98))+ labs(caption = &quot;Figure 2: The above figure depicts the variance in average baseflow on \\n the left y-axis and the variance in peak SWE on the right y-axis across the station pairs.&quot;)+ theme(plot.caption = element_text(hjust = 0.5)) To find the onset of melt, the cumulative sum of the runoff was calculated for each water year. Using the cumulative sum, the onset of melt was selected as the first day when the daily slope was K times greater than the baseflow slope. The constant K was determined to be 6 after testing other values in order to ensure that an onset of melt date was selected for a reasonable time frame. The baseflow slope was calculated between January 1 and March 31. #create empty df to store MY results columns &lt;- c(&quot;site_no&quot;, &quot;MY_start&quot;) avg_qbase_results &lt;- data.frame(matrix(nrow = 0, ncol = length(columns))) colnames(avg_qbase_results) = columns #Onset of melt occurs when the daily slope of cumulative baseflow * K = daily slope of cumulative runoff #finds one slope value per year for baseflow (Jan1-March31) winter_nest &lt;- sitedata_clean %&gt;% mutate(month = month(Date), day = yday(Date)) %&gt;% group_by(site_no, WY) %&gt;% mutate(cs_WY = cumsum(q_mmd)) %&gt;% arrange(Date) %&gt;% filter(month %in% 1:3) %&gt;% arrange(site_no, Date) %&gt;% nest() winter_bflow &lt;- winter_nest %&gt;% mutate(mods = map(data, ~ lm(cs_WY ~ day, data = .x))) %&gt;% mutate(slope = map(mods, broom::tidy)) %&gt;% dplyr::select(-mods,-data) %&gt;% unnest(slope) %&gt;% filter(term == &#39;day&#39;) %&gt;% rename(baseslope = estimate) %&gt;% dplyr::select(site_no, WY, baseslope)%&gt;% mutate(K_base12 = baseslope * 12, K_base10 = baseslope * 10, K_base6 = baseslope * 6) #need one slope value per day not per year like winter_bflow snowmelt_nest &lt;- sitedata_clean %&gt;% mutate(month = month(Date), day = yday(Date)) %&gt;% group_by(site_no, WY) %&gt;% mutate(cs_WY = cumsum(q_mmd)) %&gt;% arrange(site_no, Date) %&gt;% filter(month %in% 4:6) %&gt;% arrange(site_no, Date) dailyslope &lt;- snowmelt_nest %&gt;% mutate(dailys = cs_WY - lag(cs_WY)) #when dailyslope &gt;= baseslope *12, pull min date #if(baseslope * 12 &gt;= dailyslope, Date(need first occurrence), &quot;&quot;) pickonset &lt;- dailyslope %&gt;% left_join(winter_bflow, by = c(&#39;WY&#39;, &#39;site_no&#39;)) %&gt;% mutate(start = if_else(dailys &gt;= K_base6, 1, 0)) avg_qbase &lt;- pickonset %&gt;% filter(start == 1) %&gt;% group_by(site_no, year = year(Date)) %&gt;% mutate(MY_start = min(Date)) avg_qbase_results &lt;- avg_qbase %&gt;% dplyr::select(site_no, MY_start, year) %&gt;% mutate(my = year(MY_start)) %&gt;% ungroup() %&gt;% distinct(site_no, my, .keep_all = T) %&gt;% mutate(MY_end = dplyr::lead(MY_start,1)-1) %&gt;% mutate(my_length = MY_end - MY_start) faster_joinery &lt;- function(one_place, one_site ){ one_place %&gt;% ungroup(.) %&gt;% fuzzy_left_join(one_site, by = c(&#39;Date&#39; = &#39;MY_start&#39;, &#39;Date&#39; = &#39;MY_end&#39;), match_fun = list(`&gt;=`,`&lt;=`)) %&gt;% filter(!is.na(my)) } site_my_bundle &lt;- sitedata_clean %&gt;% group_by(site_no) %&gt;% nest() sitedata_q_bundle &lt;- avg_qbase_results %&gt;% group_by(site_no) %&gt;% nest() %&gt;% rename(my_data = data) plan(multicore, workers = 6) bundles &lt;- inner_join(site_my_bundle,sitedata_q_bundle) %&gt;% mutate(new_data = future_map2(data,my_data,faster_joinery)) MY &lt;- bundles %&gt;% dplyr::select(-my_data, -data) %&gt;% unnest(new_data) MY &lt;- read_csv(file = &#39;data/MY.csv&#39;, col_names = TRUE) MY_sitedata &lt;- MY %&gt;% dplyr::select(-WY, -year) save(MY_sitedata, file = &#39;data/my_sitedata.RData&#39;) Once the MY was identified, we ranked and found the probability of exceedance for each discharge value. Flow duration curves (FDC) were constructed by plotting the discharge values against the probability of exceedance for each value per year (Figure 3). The discharge values that fell within 50-90% probability were deemed to be baseflow (Smakhtin, 2001) (Figure 3). Then, we directly correlated peak SWE and the average baseflow values from the same MY. We also compared average baseflow to the previous years’ peak SWE using a 5, 4, 3, 2, 1, and 0-year lag. For example, MY 1980 average baseflow was compared to peak SWE from MY 1975-1980. Figure 3: the above figure depicts a sample flow duration curve (FDC) with baseflow isolated in gray. The WY is displayed on the left and the MY is displayed on the right. #Rank each day&#39;s q_mmd value by magnitude #Find probability of each rank #Extract q_mmd values for 0.5-0.9 probability (Qbase for the MY) load(&#39;data/my_sitedata.RData&#39;) fdc &lt;- MY_sitedata %&gt;% group_by(site_no, my) %&gt;% mutate(rank = rank(-q_mmd), rankmax = max(rank), prob = rank/rankmax) %&gt;% filter(prob &gt;= 0.5 &amp; prob &lt;= 0.9) %&gt;% mutate(avg_qbase = mean(q_mmd, na.rm = T)) avg_val &lt;- fdc %&gt;% dplyr::select(site_no,my,avg_qbase) %&gt;% distinct(avg_qbase) %&gt;% pivot_wider(names_from = &#39;site_no&#39;, values_from = &#39;avg_qbase&#39;) Table 2: The below table shows the coefficients of variation (COV) for baseflow and peak SWE at each of the station pairs. #correlate fraser WY with MY fraserWY &lt;- sitedata_clean %&gt;% filter(site_no == &quot;09032100&quot;) %&gt;% group_by(WY) %&gt;% mutate(rank = rank(-q_mmd), rankmax = max(rank), prob = rank/rankmax) %&gt;% filter(prob &gt;= 0.5 &amp; prob &lt;= 0.9) %&gt;% mutate(wyavg_qbase = mean(q_mmd, na.rm = T)) wyavgfraser &lt;- fraserWY %&gt;% dplyr::select(site_no,WY,wyavg_qbase) %&gt;% distinct(wyavg_qbase) %&gt;% mutate(pairname = &quot;fraser&quot;) #pivot_wider(names_from = &#39;pairname&#39;, values_from = &#39;wyavg_qbase&#39;) myavgfraser &lt;- avg_val %&gt;% filter(site_no == &quot;9032100&quot;) %&gt;% mutate(pairname = &quot;fraser&quot;, WY = my) fraserjoin &lt;- wyavgfraser %&gt;% left_join(y = myavgfraser, by = c(&quot;pairname&quot;,&quot;WY&quot;)) %&gt;% na.omit() %&gt;% ungroup() frasercorrel &lt;- fraserjoin %&gt;% summarize(correl = cor(avg_qbase, wyavg_qbase)) Then, we directly correlated peak SWE and the average baseflow values from the same MY. We also compared average baseflow to the previous years’ peak SWE using a 5, 4, 3, 2, 1, and 0-year lag. For example, MY 1980 average baseflow was compared to peak SWE from MY 1975-1980. #download snow data and join to avg baseflow data SNOTEL_all &lt;- snotel_download(site_id = c(551,838,335,586,457,380,680,618,842,431,542,369), path = tempdir(&#39;../data&#39;), internal = TRUE) sno_clean &lt;- SNOTEL_all %&gt;% dplyr::select(network, site_id, site_name, snow_water_equivalent, Date = date) %&gt;% addWaterYear() peak_swe &lt;- sno_clean %&gt;% mutate(Date = lubridate::ymd(Date)) %&gt;% group_by(site_id, waterYear) %&gt;% summarise(max_swe = max(snow_water_equivalent, na.rm=TRUE)) %&gt;% filter(max_swe &gt; 1) %&gt;% mutate(my = waterYear) stationcodes &lt;- read_csv(&#39;data/stationcodes.csv&#39;) %&gt;% mutate(site_no = str_replace_all(site_no, &#39;&quot;&#39;,&#39;&#39;)) avgbase_join &lt;- avg_val %&gt;% pivot_longer(cols = starts_with(&quot;0&quot;), names_to = &quot;site_no&quot;, values_to = &quot;q_mmd&quot;) %&gt;% left_join(stationcodes, by = &quot;site_no&quot;) big_join &lt;- avgbase_join %&gt;% left_join(peak_swe, by = c(&quot;site_id&quot;,&quot;my&quot;)) %&gt;% dplyr::select(-waterYear) The peak SWE values were sorted into low, average, and high snow years using a histogram separating the bins by 0.5 standard deviations from the mean. A multivariate regression was run on average baseflow values with the intercept being a 0–5-year lag to peak SWE. This was calculated for low, high and all snow years. Covariance was calculated for the same parameters as well. Finally, the standard deviation and coefficient of variation (COV) of the average baseflow and peak SWE were calculated for each station pair. The COV was calculated by dividing the standard deviation by the mean for both baseflow and peak SWE. #Correlate MY vs peak SWE all years (0–5-year lags) #Separate low and high snow years using 0.5 std. dev. from mean #Run direct correlation for individual years from 0 to 5-year lags for all years, then low and high snow years big_join &lt;- read_csv(file = &#39;data/readyforcorrel.csv&#39;, col_names = TRUE) lags &lt;- big_join %&gt;% group_by(paircode) %&gt;% mutate(swelag1 = lag(max_swe, order_by = my), swelag2 = lag(swelag1, order_by = my), swelag3 = lag(swelag2, order_by = my), swelag4 = lag(swelag3, order_by = my), swelag5 = lag(swelag4, order_by = my)) #correlation between all snow years and avg baseflow all &lt;- lags %&gt;% group_by(site_no,site_id, pairname) %&gt;% na.omit(.) %&gt;% summarize(lag0 = cor(max_swe, q_mmd), lag1 = cor(swelag1, q_mmd), lag2 = cor(swelag2, q_mmd), lag3 = cor(swelag3, q_mmd), lag4 = cor(swelag4, q_mmd), lag5 = cor(swelag5, q_mmd)) longsnowcore &lt;- all %&gt;% pivot_longer(cols = starts_with(&quot;lag&quot;),values_to = &quot;correl&quot;, names_to = &quot;lag&quot;) #correlation between high snow years and avg baseflow snow_hi_lo &lt;- lags %&gt;% group_by(pairname) %&gt;% na.omit(.) %&gt;% mutate(quants = ifelse(max_swe &gt; mean(max_swe) + sd(max_swe)*.5, &#39;hi&#39;,&#39;avg&#39;), quants = ifelse(max_swe &lt; mean(max_swe) - sd(max_swe)*.5,&#39;lo&#39;,quants)) high &lt;- snow_hi_lo %&gt;% group_by(site_no,site_id, pairname) %&gt;% na.omit(.) %&gt;% filter(quants == &quot;hi&quot;) %&gt;% summarize(lag0 = cor(max_swe, q_mmd), lag1 = cor(swelag1, q_mmd), lag2 = cor(swelag2, q_mmd), lag3 = cor(swelag3, q_mmd), lag4 = cor(swelag4, q_mmd), lag5 = cor(swelag5, q_mmd)) longhigh &lt;- high %&gt;% pivot_longer(cols = starts_with(&quot;lag&quot;),values_to = &quot;correl&quot;, names_to = &quot;lag&quot;) #correlation between low snow years and avg baseflow low &lt;- snow_hi_lo %&gt;% group_by(site_no,site_id, pairname) %&gt;% na.omit(.) %&gt;% filter(quants == &quot;lo&quot;) %&gt;% summarize(lag0 = cor(max_swe, q_mmd), lag1 = cor(swelag1, q_mmd), lag2 = cor(swelag2, q_mmd), lag3 = cor(swelag3, q_mmd), lag4 = cor(swelag4, q_mmd), lag5 = cor(swelag5, q_mmd)) longlow &lt;- low %&gt;% pivot_longer(cols = starts_with(&quot;lag&quot;),values_to = &quot;correl&quot;, names_to = &quot;lag&quot;) #find covariance between peak SWE and avg baseflow for all, high and low snow years allcov &lt;- lags %&gt;% group_by(site_no,site_id, pairname) %&gt;% na.omit(.) %&gt;% summarize(lag0 = cov(max_swe, q_mmd), lag1 = cov(swelag1, q_mmd), lag2 = cov(swelag2, q_mmd), lag3 = cov(swelag3, q_mmd), lag4 = cov(swelag4, q_mmd), lag5 = cov(swelag5, q_mmd)) highcov &lt;- snow_hi_lo %&gt;% group_by(site_no,site_id, pairname) %&gt;% na.omit(.) %&gt;% filter(quants == &quot;hi&quot;) %&gt;% summarize(lag0 = cov(max_swe, q_mmd), lag1 = cov(swelag1, q_mmd), lag2 = cov(swelag2, q_mmd), lag3 = cov(swelag3, q_mmd), lag4 = cov(swelag4, q_mmd), lag5 = cov(swelag5, q_mmd)) lowcov &lt;- snow_hi_lo %&gt;% group_by(site_no,site_id, pairname) %&gt;% na.omit(.) %&gt;% filter(quants == &quot;lo&quot;) %&gt;% summarize(lag0 = cov(max_swe, q_mmd), lag1 = cov(swelag1, q_mmd), lag2 = cov(swelag2, q_mmd), lag3 = cov(swelag3, q_mmd), lag4 = cov(swelag4, q_mmd), lag5 = cov(swelag5, q_mmd)) The Fraser sites were used as a case study to examen the results on a small signular basin scale. fraser &lt;- read_csv(file = &#39;data/readyforcorrel.csv&#39;, col_names = TRUE) highsno &lt;- mean(fraser$max_swe) + sd(fraser$max_swe)*0.5 lowsno &lt;- mean(fraser$max_swe) - sd(fraser$max_swe)*0.5 mean &lt;- mean(fraser$max_swe) Basin characteristics like drainage area, elevation, and latitude were then examined with respect to the results from the correlation between peak SWE and baseflow as well as the contrast between 0-5-year lags. "],["results.html", "Chapter 5 Results", " Chapter 5 Results Load packages library(tidyverse) library(tidyr) library(httr) library(jsonlite) library(plotly) library(lubridate) library(dataRetrieval) library(sf) library(mapview) library(readr) library(dplyr) library(purrr) library(fuzzyjoin) library(furrr) library(&quot;snotelr&quot;) library(readxl) library(stats) library(tmap) library(tigris) library(elevatr) library(raster) library(ggplot2) The correlation between the MY and WY is low at the Fraser stations with R = 0.30. This was consistent across basins. This is expected because the WY baseflow values can occur during two different calendar years when calculating baseflow using FDC (Figure 3). MY baseflow values occur during one calendar year because melt begins the year. The correlation between the MY average baseflow and peak SWE is positive when the values are from the same year (Figure 4). This trend also occurs with a lag of 3 years (Figure 5). The correlation across the basins becomes less consistent with lag 4 and lag 5 (Figure 5). After splitting the times series into low and high snow years, the correlation changed. The high snow years tended to show a high correlation across most lags (Figure 5). However, the low snow years had much more variability across the lags (Figure 5). big_join &lt;- read_csv(file = &#39;data/readyforcorrel.csv&#39;, col_names = TRUE) fraser &lt;- big_join %&gt;% filter(pairname == &quot;fraser&quot;) fraser &lt;- read_csv(file = &#39;data/fraser.csv&#39;, col_names = TRUE) ggplot(fraser, aes(x = max_swe, y = q_mmd))+ geom_point()+ ggthemes::theme_few()+ labs(x = &quot;Peak SWE (mm)&quot;, y = &quot;Average Baseflow (mm/d)&quot;)+ geom_smooth(method=lm, se = FALSE)+ labs(caption = &quot;Figure 4: The above figure shows the correlation between peak SWE\\n and average MY baseflow from the same year at the Fraser stations.&quot; )+ theme(plot.caption = element_text(hjust = 0.5)) high &lt;- read_csv(file = &#39;data/high.csv&#39;, col_names = TRUE) low &lt;- read_csv(file = &#39;data/low.csv&#39;, col_names = TRUE) all &lt;- read_csv(file = &#39;data/all.csv&#39;, col_names = TRUE) datas &lt;- bind_rows(all %&gt;% mutate(data = &#39;all&#39;), high %&gt;% mutate(data = &#39;high&#39;)) %&gt;% bind_rows(low %&gt;% mutate(data = &#39;low&#39;)) %&gt;% pivot_longer(., lag0:lag5 ) ggplot(datas, aes(x = name, y=value, fill = pairname )) + geom_bar(stat = &#39;identity&#39;, position = &#39;dodge&#39;) + ggthemes::theme_few() + scale_fill_viridis_d() + facet_wrap(~data, ncol = 1)+ labs(caption = &quot;Figure 5: The above figure depicts the correlations between peak SWE and average \\n MY baseflow across and all, high, and low snow years for all stations with lags 0-5.&quot;, y = &quot;R value&quot;, x = &quot;&quot;) frasercorrel &lt;- datas %&gt;% filter(pairname == &#39;fraser&#39;) ggplot(frasercorrel, aes(x = name, y=value, fill = data )) + geom_bar(stat = &#39;identity&#39;, position = &#39;dodge&#39;) + ggthemes::theme_few() + scale_fill_viridis_d()+ labs(caption = &quot;Figure 6: The above figure depicts the summary of the correlation values \\n at the Fraser stations across lags and all, high and low snow years.&quot;, x = &quot;&quot;, y = &quot;R value&quot;)+ theme(plot.caption = element_text(hjust = 0.5)) The covariance analysis showed similar results with greatly consistency amongst stations for all and high snow years, and greater positive trends in lags 0-3. Again, the low snow years were inconsistent, more negative, and generally lower (Figure 7). highcov &lt;- read_csv(file = &#39;data/highcov.csv&#39;, col_names = TRUE) lowcov &lt;- read_csv(file = &#39;data/lowcov.csv&#39;, col_names = TRUE) allcov &lt;- read_csv(file = &#39;data/allcov.csv&#39;, col_names = TRUE) datacov &lt;- bind_rows(allcov %&gt;% mutate(data = &#39;all&#39;), highcov %&gt;% mutate(data = &#39;high&#39;)) %&gt;% bind_rows(lowcov %&gt;% mutate(data = &#39;low&#39;)) %&gt;% pivot_longer(., lag0:lag5 ) ggplot(datacov, aes(x = name, y=value, fill = pairname )) + geom_bar(stat = &#39;identity&#39;, position = &#39;dodge&#39;) + ggthemes::theme_few() + scale_fill_viridis_d() + facet_wrap(~data, ncol = 1)+ labs(caption = &quot;Figure 7: The above figure depicts the summary of the variance values \\n at the all stations across lags and all, high and low snow years.&quot;, y = &quot;Covariance value&quot;, x = &quot;&quot;)+ theme(plot.caption = element_text(hjust = 0.5)) The results of the multivariate regressions were inconclusive. The correlation coefficients and p-values were not significant across most basins. Table 2: The table below shows the coefficients of variation (COV) for baseflow and peak SWE at each of the station pairs. The standard deviation of baseflow and peak SWE were relatively similar across stations. However, the magnitude of the variation in baseflow was much smaller than that of the peak SWE. The COV were similar for baseflow and peak SWE at most stations with obvious outliers being the Steamboat and Vail station pairs (Table 2). Basins that were in similar spatial locations tended to have similar correlation and covariance values when correlating all years and high snow years. The low snow years varied enough that there did not appear to be any basin characteristic in common. "],["discussion.html", "Chapter 6 Discussion 6.1 Conclusion", " Chapter 6 Discussion Load packages library(tidyverse) library(tidyr) library(httr) library(jsonlite) library(plotly) library(lubridate) library(dataRetrieval) library(sf) library(mapview) library(readr) library(dplyr) library(purrr) library(fuzzyjoin) library(furrr) library(&quot;snotelr&quot;) library(readxl) library(stats) library(tmap) library(tigris) library(elevatr) library(raster) Using FDCs, baseflow computed as it occurs after snowmelt has a very low correlation to baseflow computed using the traditional WY across the study basins. This is to be expected given that the date range of the MY is significantly different from the WY. Overall, there appears to be a slight positive correlation between peak SWE and baseflow in from the same MY (Figure 4). This is likely due to the relatively small basin size and snow-dominated nature of these systems. The variability of correlation values within the low snow years is likely because there is high interannual variability in peak SWE (Figure 8). High years could influence the lag effects of low snow years to the point that a correlation is not obvious in the low snow years. High snow years clearly have a lasting impact on the amount of water in the streams during the same year that the melt occurs, and for a few years after even if a low year follows (Figure 5). It is likely that this is also the reason that the covariance values followed these same general trends. The standard deviations and COV were similar across most station pairs except for Vail and Steamboat. Vail had generally lower baseflow values with more high outliers than the other stations, and Steamboat also had high baseflow outliers in the time series. In general, the normalized variation in baseflow and peak SWE were similar for the time series (Table 2). This is likely because baseflow and peak SWE from the same year were positively correlated for most stations (Figure 5). It is important to note that, because COV values are normalized, there can appear to be large variability in average baseflow when the total standard deviation is less than 0.15 mm/day for every station examined which is a very small quantity of water. The multivariate regressions were not able to indicate any trends across basins. Basins that had a positive correlation coefficient or p-value were likely false positives due to the small number of years compared to the number of variables (lags). In the future, it could be useful to decrease the number of lags and only use lags 0 through 3. Increasing the total number of years in the time series could also improve results. Using just high snow or just low snow years will likely not provide a large enough sample size to run an accurate regression. highsno &lt;- mean(fraser$max_swe) + sd(fraser$max_swe)*0.5 lowsno &lt;- mean(fraser$max_swe) - sd(fraser$max_swe)*0.5 mean &lt;- mean(fraser$max_swe) ggplot(fraser, aes(x = my, y = max_swe))+ geom_line()+ geom_point()+ ggthemes::theme_few()+ labs(x = &quot;Year&quot;, y = &quot;Peak SWE (mm)&quot;)+ geom_hline(aes(yintercept = highsno), color = &#39;blue4&#39;)+ geom_hline(aes(yintercept = mean), color = &#39;blue&#39;)+ geom_hline(aes(yintercept = lowsno), color = &quot;lightblue3&quot;)+ labs(caption = &quot;Figure 8: The above figure depicts the interannual variability in peak SWE at the Fraser \\n stations for the complete time series.&quot;)+ theme(plot.caption = element_text(hjust = 0.5)) The similarities across spatially similar basins were likely due to similar latitudes, peak SWE values, and onset of melt timing. However, a potential next step for this research is to group the watersheds by landcover and orientation to evaluate the impact that these traits might have on the correlation between peak SWE and baseflow. Common landcover types in this region include herbaceous, evergreen forest, shrub/scrub, and perennial ice/snow. Depending on the type and quantity of vegetation in a basin, snowmelt could be absorbed or runoff differently. The orientation of the basin could indicate the amount of incoming solar radiation and, therefore, evaporation of SWE prior to entering the stream. In addition, the slope of the basin or elevational gradient could indicate that water is running off into the stream faster with less time for absorption or evaporation. As mentioned earlier, the use of isotopic tracers could get to the answer to the question “do snowmelt contributions to streams have a lagged impact on baseflow?” Future research could examine what proportions of streamflow are “old” versus “new” water to see how much snowmelt is stored from previous years. Rain on snow events, while not common at these paired stations currently, could become more common in the future with climate change (Miller et al., 2014; Dierauer et al., 2018) leading to a scenario in which we cannot assume that 100% of low flows are baseflow. Isotopic tracers could improve the accuracy and understanding of this method. 6.1 Conclusion In snow-dominated watersheds, snowmelt is the primary driver of increases in streamflow in the spring. Baseflow appears to be correlated to peak SWE especially during the same year. This trend can continue with subsequently lagged years during high-snow years. However, due to interannual variability in peak SWE in Colorado, the impact of low-snow years on this trend is variable. This is important to understand because high snow years can potentially mute the impacts of low-snow years on the watershed. While further investigation of basins characteristics is needed, it appears that basins of similar latitudes, location and area tend to have similar correlations between baseflow and peak SWE. "],["references.html", "References", " References Cooper, M. G., Schaperow, J. R., Cooley, S. W., Alam, S., Smith, L. C., &amp; Lettenmaier, D. P. (2018). Climate elasticity of low flows in the Maritime Western U.S. Mountains. Water Resources Research, 54(8), 5602–5619. https://doi.org/10.1029/2018wr022816 Dierauer, J. R., Whitfield, P. H., &amp; Allen, D. M. (2018). Climate Controls on runoff and low flows in mountain catchments of western North America. Water Resources Research, 54(10), 7495–7510. https://doi.org/10.1029/2018wr023087 Fassnacht, S. R., and J. E. Derry (2010), Defining similar regions of snow in the Colorado River Basin using self‐organizing maps, Water Resour. Res., 46, W04507, doi:10.1029/2009WR007835. Godsey, S. E., Kirchner, J. W., &amp; Tague, C. L. (2013). Effects of changes in winter snowpacks on Summer low flows: Case studies in the sierra Nevada, California, USA. Hydrological Processes, 28(19), 5048–5064. https://doi.org/10.1002/hyp.9943 Hammond, J. C., &amp; Kampf, S. K. (2020). Subannual streamflow responses to rainfall and snowmelt inputs in snow‐dominated watersheds of the Western United States. Water Resources Research, 56(4). https://doi.org/10.1029/2019wr026132 Miller, M. P., Susong, D. D., Shope, C. L., Heilweil, V. M., and Stolp, B. J. (2014), Continuous estimation of baseflow in snowmelt-dominated streams and rivers in the Upper Colorado River Basin: A chemical hydrograph separation approach, Water Resour. Res., 50, 6986– 6999, doi:10.1002/2013WR014939. Smakhtin, V. U. (2001). Low flow hydrology: A Review. Journal of Hydrology, 240(3-4), 147–186. https://doi.org/10.1016/s0022-1694(00)00340-1 "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
